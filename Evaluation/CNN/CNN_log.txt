Using device: cpu

=== Training with parameters: {'learning_rate': 0.001, 'batch_size': 32} ===

Epoch 1/25
Training:  Loss =Total 671.0804
Testing:  Average Loss = 0.4450, Accuracy = 0.8884
Best model saved with accuracy: 0.8884

Epoch 2/25
Training:  Loss =Total 177.3226
Testing:  Average Loss = 0.2178, Accuracy = 0.9426
Best model saved with accuracy: 0.9426

Epoch 3/25
Training:  Loss =Total 110.3957
Testing:  Average Loss = 0.1669, Accuracy = 0.9531
Best model saved with accuracy: 0.9531

Epoch 4/25
Training:  Loss =Total 81.2007
Testing:  Average Loss = 0.1347, Accuracy = 0.9645
Best model saved with accuracy: 0.9645

Epoch 5/25
Training:  Loss =Total 67.3655
Testing:  Average Loss = 0.1150, Accuracy = 0.9719
Best model saved with accuracy: 0.9719

Epoch 6/25
Training:  Loss =Total 54.6268
Testing:  Average Loss = 0.1039, Accuracy = 0.9741
Best model saved with accuracy: 0.9741

Epoch 7/25
Training:  Loss =Total 46.2233
Testing:  Average Loss = 0.0916, Accuracy = 0.9776
Best model saved with accuracy: 0.9776

Epoch 8/25
Training:  Loss =Total 42.7757
Testing:  Average Loss = 0.0874, Accuracy = 0.9776

Epoch 9/25
Training:  Loss =Total 37.9506
Testing:  Average Loss = 0.0875, Accuracy = 0.9784
Best model saved with accuracy: 0.9784

Epoch 10/25
Training:  Loss =Total 32.6650
Testing:  Average Loss = 0.0798, Accuracy = 0.9795
Best model saved with accuracy: 0.9795

Epoch 11/25
Training:  Loss =Total 31.4720
Testing:  Average Loss = 0.0764, Accuracy = 0.9801
Best model saved with accuracy: 0.9801

Epoch 12/25
Training:  Loss =Total 29.5248
Testing:  Average Loss = 0.0865, Accuracy = 0.9804
Best model saved with accuracy: 0.9804

Epoch 13/25
Training:  Loss =Total 27.9486
Testing:  Average Loss = 0.0809, Accuracy = 0.9815
Best model saved with accuracy: 0.9815

Epoch 14/25
Training:  Loss =Total 24.2917
Testing:  Average Loss = 0.0760, Accuracy = 0.9810

Epoch 15/25
Training:  Loss =Total 22.8874
Testing:  Average Loss = 0.0712, Accuracy = 0.9830
Best model saved with accuracy: 0.9830

Epoch 16/25
Training:  Loss =Total 21.9738
Testing:  Average Loss = 0.0749, Accuracy = 0.9830

Epoch 17/25
Training:  Loss =Total 20.5338
Testing:  Average Loss = 0.0723, Accuracy = 0.9824

Epoch 18/25
Training:  Loss =Total 19.7541
Testing:  Average Loss = 0.0692, Accuracy = 0.9844
Best model saved with accuracy: 0.9844

Epoch 19/25
Training:  Loss =Total 18.2828
Testing:  Average Loss = 0.0687, Accuracy = 0.9847
Best model saved with accuracy: 0.9847

Epoch 20/25
Training:  Loss =Total 20.1332
Testing:  Average Loss = 0.0701, Accuracy = 0.9838

Epoch 21/25
Training:  Loss =Total 16.4602
Testing:  Average Loss = 0.0731, Accuracy = 0.9830

Epoch 22/25
Training:  Loss =Total 15.8221
Testing:  Average Loss = 0.0722, Accuracy = 0.9832

Epoch 23/25
Training:  Loss =Total 16.0194
Testing:  Average Loss = 0.0728, Accuracy = 0.9835

Epoch 24/25
Training:  Loss =Total 16.0329
Testing:  Average Loss = 0.0748, Accuracy = 0.9815

Epoch 25/25
Training:  Loss =Total 14.7597
Testing:  Average Loss = 0.0698, Accuracy = 0.9827
Final accuracy for these parameters: 0.9847
------------------------------------------------------------

=== Training with parameters: {'learning_rate': 0.001, 'batch_size': 64} ===

Epoch 1/25
Training:  Loss =Total 458.0697
Testing:  Average Loss = 0.8122, Accuracy = 0.8074
Best model saved with accuracy: 0.8074

Epoch 2/25
Training:  Loss =Total 149.5570
Testing:  Average Loss = 0.3780, Accuracy = 0.9003
Best model saved with accuracy: 0.9003

Epoch 3/25
Training:  Loss =Total 89.2788
Testing:  Average Loss = 0.2487, Accuracy = 0.9318
Best model saved with accuracy: 0.9318

Epoch 4/25
Training:  Loss =Total 65.0406
Testing:  Average Loss = 0.1985, Accuracy = 0.9489
Best model saved with accuracy: 0.9489

Epoch 5/25
Training:  Loss =Total 51.0081
Testing:  Average Loss = 0.1715, Accuracy = 0.9554
Best model saved with accuracy: 0.9554

Epoch 6/25
Training:  Loss =Total 43.3535
Testing:  Average Loss = 0.1479, Accuracy = 0.9611
Best model saved with accuracy: 0.9611

Epoch 7/25
Training:  Loss =Total 38.0384
Testing:  Average Loss = 0.1307, Accuracy = 0.9668
Best model saved with accuracy: 0.9668

Epoch 8/25
Training:  Loss =Total 33.4413
Testing:  Average Loss = 0.1228, Accuracy = 0.9670
Best model saved with accuracy: 0.9670

Epoch 9/25
Training:  Loss =Total 30.1952
Testing:  Average Loss = 0.1211, Accuracy = 0.9662

Epoch 10/25
Training:  Loss =Total 27.5424
Testing:  Average Loss = 0.1053, Accuracy = 0.9722
Best model saved with accuracy: 0.9722

Epoch 11/25
Training:  Loss =Total 24.3844
Testing:  Average Loss = 0.1043, Accuracy = 0.9736
Best model saved with accuracy: 0.9736

Epoch 12/25
Training:  Loss =Total 22.1358
Testing:  Average Loss = 0.0999, Accuracy = 0.9770
Best model saved with accuracy: 0.9770

Epoch 13/25
Training:  Loss =Total 20.9960
Testing:  Average Loss = 0.0964, Accuracy = 0.9753

Epoch 14/25
Training:  Loss =Total 20.2572
Testing:  Average Loss = 0.0916, Accuracy = 0.9759

Epoch 15/25
Training:  Loss =Total 17.8192
Testing:  Average Loss = 0.0910, Accuracy = 0.9776
Best model saved with accuracy: 0.9776

Epoch 16/25
Training:  Loss =Total 17.1492
Testing:  Average Loss = 0.0854, Accuracy = 0.9795
Best model saved with accuracy: 0.9795

Epoch 17/25
Training:  Loss =Total 16.7715
Testing:  Average Loss = 0.0847, Accuracy = 0.9793

Epoch 18/25
Training:  Loss =Total 15.0568
Testing:  Average Loss = 0.0826, Accuracy = 0.9812
Best model saved with accuracy: 0.9812

Epoch 19/25
Training:  Loss =Total 15.2218
Testing:  Average Loss = 0.0809, Accuracy = 0.9801

Epoch 20/25
Training:  Loss =Total 14.6475
Testing:  Average Loss = 0.0793, Accuracy = 0.9804

Epoch 21/25
Training:  Loss =Total 13.7084
Testing:  Average Loss = 0.0829, Accuracy = 0.9784

Epoch 22/25
Training:  Loss =Total 12.9497
Testing:  Average Loss = 0.0811, Accuracy = 0.9812

Epoch 23/25
Training:  Loss =Total 13.0813
Testing:  Average Loss = 0.0770, Accuracy = 0.9801

Epoch 24/25
Training:  Loss =Total 12.4194
Testing:  Average Loss = 0.0743, Accuracy = 0.9832
Best model saved with accuracy: 0.9832

Epoch 25/25
Training:  Loss =Total 11.7409
Testing:  Average Loss = 0.0751, Accuracy = 0.9812
Final accuracy for these parameters: 0.9832
------------------------------------------------------------

=== Training with parameters: {'learning_rate': 0.01, 'batch_size': 32} ===

Epoch 1/25
Training:  Loss =Total 407.4696
Testing:  Average Loss = 0.2594, Accuracy = 0.9381
Best model saved with accuracy: 0.9381

Epoch 2/25
Training:  Loss =Total 156.7333
Testing:  Average Loss = 0.2097, Accuracy = 0.9463
Best model saved with accuracy: 0.9463

Epoch 3/25
Training:  Loss =Total 104.0913
Testing:  Average Loss = 0.1430, Accuracy = 0.9642
Best model saved with accuracy: 0.9642

Epoch 4/25
Training:  Loss =Total 77.2376
Testing:  Average Loss = 0.1382, Accuracy = 0.9690
Best model saved with accuracy: 0.9690

Epoch 5/25
Training:  Loss =Total 65.2857
Testing:  Average Loss = 0.1226, Accuracy = 0.9727
Best model saved with accuracy: 0.9727

Epoch 6/25
Training:  Loss =Total 54.7671
Testing:  Average Loss = 0.1189, Accuracy = 0.9744
Best model saved with accuracy: 0.9744

Epoch 7/25
Training:  Loss =Total 46.5791
Testing:  Average Loss = 0.1077, Accuracy = 0.9747
Best model saved with accuracy: 0.9747

Epoch 8/25
Training:  Loss =Total 43.0551
Testing:  Average Loss = 0.0944, Accuracy = 0.9767
Best model saved with accuracy: 0.9767

Epoch 9/25
Training:  Loss =Total 38.4728
Testing:  Average Loss = 0.1135, Accuracy = 0.9744

Epoch 10/25
Training:  Loss =Total 32.6701
Testing:  Average Loss = 0.0947, Accuracy = 0.9824
Best model saved with accuracy: 0.9824

Epoch 11/25
Training:  Loss =Total 28.7879
Testing:  Average Loss = 0.0938, Accuracy = 0.9810

Epoch 12/25
Training:  Loss =Total 30.9674
Testing:  Average Loss = 0.0815, Accuracy = 0.9830
Best model saved with accuracy: 0.9830

Epoch 13/25
Training:  Loss =Total 24.3954
Testing:  Average Loss = 0.0874, Accuracy = 0.9830

Epoch 14/25
Training:  Loss =Total 22.6443
Testing:  Average Loss = 0.0829, Accuracy = 0.9832
Best model saved with accuracy: 0.9832

Epoch 15/25
Training:  Loss =Total 18.6600
Testing:  Average Loss = 0.0803, Accuracy = 0.9830

Epoch 16/25
Training:  Loss =Total 21.9433
Testing:  Average Loss = 0.0760, Accuracy = 0.9849
Best model saved with accuracy: 0.9849

Epoch 17/25
Training:  Loss =Total 20.2722
Testing:  Average Loss = 0.0872, Accuracy = 0.9827

Epoch 18/25
Training:  Loss =Total 19.9348
Testing:  Average Loss = 0.0882, Accuracy = 0.9832

Epoch 19/25
Training:  Loss =Total 18.6778
Testing:  Average Loss = 0.0801, Accuracy = 0.9855
Best model saved with accuracy: 0.9855

Epoch 20/25
Training:  Loss =Total 18.0731
Testing:  Average Loss = 0.0848, Accuracy = 0.9835

Epoch 21/25
Training:  Loss =Total 16.6783
Testing:  Average Loss = 0.0923, Accuracy = 0.9827

Epoch 22/25
Training:  Loss =Total 18.4532
Testing:  Average Loss = 0.0874, Accuracy = 0.9830

Epoch 23/25
Training:  Loss =Total 14.9805
Testing:  Average Loss = 0.0839, Accuracy = 0.9830

Epoch 24/25
Training:  Loss =Total 14.5655
Testing:  Average Loss = 0.0905, Accuracy = 0.9821

Epoch 25/25
Training:  Loss =Total 15.2968
Testing:  Average Loss = 0.0733, Accuracy = 0.9855
Final accuracy for these parameters: 0.9855
------------------------------------------------------------

=== Training with parameters: {'learning_rate': 0.01, 'batch_size': 64} ===

Epoch 1/25
Training:  Loss =Total 207.9621
Testing:  Average Loss = 0.2227, Accuracy = 0.9386
Best model saved with accuracy: 0.9386

Epoch 2/25
Training:  Loss =Total 53.3256
Testing:  Average Loss = 0.1433, Accuracy = 0.9563
Best model saved with accuracy: 0.9563

Epoch 3/25
Training:  Loss =Total 34.7802
Testing:  Average Loss = 0.1312, Accuracy = 0.9653
Best model saved with accuracy: 0.9653

Epoch 4/25
Training:  Loss =Total 28.9632
Testing:  Average Loss = 0.1027, Accuracy = 0.9724
Best model saved with accuracy: 0.9724

Epoch 5/25
Training:  Loss =Total 21.5832
Testing:  Average Loss = 0.1036, Accuracy = 0.9733
Best model saved with accuracy: 0.9733

Epoch 6/25
Training:  Loss =Total 20.0604
Testing:  Average Loss = 0.0870, Accuracy = 0.9781
Best model saved with accuracy: 0.9781

Epoch 7/25
Training:  Loss =Total 18.6282
Testing:  Average Loss = 0.0872, Accuracy = 0.9787
Best model saved with accuracy: 0.9787

Epoch 8/25
Training:  Loss =Total 14.9559
Testing:  Average Loss = 0.0883, Accuracy = 0.9827
Best model saved with accuracy: 0.9827

Epoch 9/25
Training:  Loss =Total 14.3463
Testing:  Average Loss = 0.0867, Accuracy = 0.9818

Epoch 10/25
Training:  Loss =Total 13.2805
Testing:  Average Loss = 0.0811, Accuracy = 0.9852
Best model saved with accuracy: 0.9852

Epoch 11/25
Training:  Loss =Total 12.8862
Testing:  Average Loss = 0.0816, Accuracy = 0.9827

Epoch 12/25
Training:  Loss =Total 12.2780
Testing:  Average Loss = 0.0906, Accuracy = 0.9830

Epoch 13/25
Training:  Loss =Total 10.5548
Testing:  Average Loss = 0.0846, Accuracy = 0.9830

Epoch 14/25
Training:  Loss =Total 9.2381
Testing:  Average Loss = 0.0805, Accuracy = 0.9824

Epoch 15/25
Training:  Loss =Total 9.0589
Testing:  Average Loss = 0.0974, Accuracy = 0.9798

Epoch 16/25
Training:  Loss =Total 9.9668
Testing:  Average Loss = 0.0859, Accuracy = 0.9804

Epoch 17/25
Training:  Loss =Total 7.8747
Testing:  Average Loss = 0.0919, Accuracy = 0.9781

Epoch 18/25
Training:  Loss =Total 7.8230
Testing:  Average Loss = 0.0835, Accuracy = 0.9807

Epoch 19/25
Training:  Loss =Total 7.4642
Testing:  Average Loss = 0.0822, Accuracy = 0.9844

Epoch 20/25
Training:  Loss =Total 6.8950
Testing:  Average Loss = 0.0769, Accuracy = 0.9847

Epoch 21/25
Training:  Loss =Total 6.8997
Testing:  Average Loss = 0.0908, Accuracy = 0.9852

Epoch 22/25
Training:  Loss =Total 6.9397
Testing:  Average Loss = 0.0863, Accuracy = 0.9838

Epoch 23/25
Training:  Loss =Total 6.7561
Testing:  Average Loss = 0.0814, Accuracy = 0.9832

Epoch 24/25
Training:  Loss =Total 6.4848
Testing:  Average Loss = 0.0866, Accuracy = 0.9827

Epoch 25/25
Training:  Loss =Total 6.2979
Testing:  Average Loss = 0.0789, Accuracy = 0.9844
Final accuracy for these parameters: 0.9852
------------------------------------------------------------

=== Best parameters found ===
Parameters: {'learning_rate': 0.01, 'batch_size': 32}
Accuracy: 0.9855

Best model saved to: models/best_model.pth